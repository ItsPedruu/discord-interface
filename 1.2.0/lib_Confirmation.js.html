<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>lib/Confirmation.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Confirmation.html">Confirmation</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Confirmation.html#.create">create</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Menu.html">Menu</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Menu.html#.create">create</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Pagination.html">Pagination</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Pagination.html#.create">create</a></span></li><li class="nav-heading">Events</li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Confirmation.html#event:confirmation">confirmation</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Confirmation.html#event:over">over</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Menu.html#event:categorySelected">categorySelected</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Menu.html#event:over">over</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Pagination.html#event:collect">collect</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Pagination.html#event:over">over</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li>
</nav>

<div id="main">
    
    <h1 class="page-title">lib/Confirmation.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const EventEmitter = require('events').EventEmitter;
const {RichEmbed} = require('discord.js');
const Constants = require('../utils/Constants.js');

/**
 * Represents a Confirmation Interface
 * @class
 */
class Confirmation extends EventEmitter {
    /**
     * @param {Message} message The discord.js message object
     * @param {ConfirmationOptions} options The options for the Confirmation Interface
     */
    constructor(message, options) {
        super();

        if (!message) throw new SyntaxError('Expected message');
        if (!options) throw new SyntaxError('Expected options');

        if (!options.userID || !options.text) throw new SyntaxError('Expected options.userID and options.text');

        this.message = message;
        this.options = Object.assign(Constants.ConfirmationOptions, options);

        this.start();
    }

    async start() {
        let message = await this.message.channel.send(new RichEmbed()
            .setColor(this.options.embedColor || 'RANDOM')
            .setDescription(this.options.text)
        );

        let reactions = [this.options.reactions.accept, this.options.reactions.decline];
        let filter = (reaction, user) => (reactions.includes(reaction.emoji.name) || reactions.includes(reaction.emoji.id)) &amp;&amp; user.id == this.options.userID;
        this.collector = message.createReactionCollector(filter, this.options);

        for (let reaction of reactions) {
            if (message.deleted) return this.collector.stop(); 
            await message.react(reaction);
        }

        this.collector.on('collect', reaction => {
            let confirmed = reaction.emoji.name == this.options.reactions.accept;

            this.emit('confirmation', confirmed);

            this.collector.stop();
        });

        this.collector.on('end', async (collected, reason) => {
            await message.delete();

            this.emit('over', reason == 'time');
        });
    }

    /**
     * Creates a Confirmation
     * @param {Message} message The discord.js message object
     * @param {ConfirmationOptions} options The options for the Confirmation Interface
     */
    static create(message, options) {
        return new Confirmation(message, options);
    }
}

/**
 * @event Confirmation#confirmation
 * @property {boolean} confirmed Whether the user confirmed
 */

/**
 * @event Confirmation#over
 * @property {boolean} timeOver Whether the reason the collector stopped is due to the time over
 */

module.exports = Confirmation;</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.2</a> using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
